{% style %}
  .cg-testimonial__image--mobile {
    display: none;
  }

  @media (max-width: 768px) {
    .cg-testimonial__image--desktop {
      display: none;
    }

    .cg-testimonial__image--mobile {
      display: block;
    }
  }
{% endstyle %}
<div
  class="cg-testimonials page-width pt-[45px] min-990:pt-[71px] pb-[59px] min-990:pb-[113px] {{ section.settings.extra_class }} color-{{ section.settings.color_scheme }}"
  data-desktop-slider="{{ section.settings.enable_desktop_slider }}"
  data-mobile-slider="{{ section.settings.enable_mobile_slider }}"
>
  {% if section.settings.heading != blank %}
    <div class="cg-testimonials__heading h2 text-center mb-[37px] min-990:mb-[68px]">
      {{ section.settings.heading }}
    </div>
  {% endif %}

  <div class="cg-testimonials__wrapper relative">
    <button class="golfers-arrow golfers-prev swiper-button-prev" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64" fill="none">
        <g>
          <circle cx="28" cy="28" r="28" transform="matrix(-1 0 0 1 60 0)" fill="white"/>
        </g>
        <path d="M37 17L25 29L37 41" stroke="black" stroke-width="2"/>
        <defs>
          <filter x="0" y="0" width="64" height="64" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="4"/>
            <feGaussianBlur stdDeviation="2"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_328_3049"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_328_3049" result="shape"/>
          </filter>
        </defs>
      </svg>
    </button>
    <button class="golfers-arrow golfers-next swiper-button-next" type="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64" fill="none">
        <g>
          <circle cx="32" cy="28" r="28" fill="white"/>
        </g>
        <path d="M27 17L39 29L27 41" stroke="black" stroke-width="2"/>
        <defs>
          <filter x="0" y="0" width="64" height="64" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
            <feOffset dy="4"/>
            <feGaussianBlur stdDeviation="2"/>
            <feComposite in2="hardAlpha" operator="out"/>
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_328_3046"/>
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_328_3046" result="shape"/>
          </filter>
        </defs>
      </svg>
    </button>
    <div class="cg-testimonials__grid{% if section.settings.enable_desktop_slider or section.settings.enable_mobile_slider == 'true' %} cg-swiper swiper{% endif %}">
      {% if section.settings.enable_desktop_slider or section.settings.enable_mobile_slider %}
        <div class="swiper-wrapper">
      {% endif %}

      {% for block in section.blocks %}
        <div
          class="cg-testimonial {{ block.settings.extra_class_slide }}{% if section.settings.enable_desktop_slider or section.settings.enable_mobile_slider %} swiper-slide{% endif %}"
          {{ block.shopify_attributes }}
        >
          <div class="cg-testimonial-inside">
            <div class="cg-testimonial__content">
              <div>
                <div class="cg-testimonial__stars min-990:hidden">
                  {% render 'golfers-stars' %}
                </div>
                {% if block.settings.quote != blank %}
                  <p class="cg-testimonial__quote">{{ block.settings.quote }}</p>
                {% endif %}
              </div>

              <div>
                <div class="cg-testimonial__stars max-990:hidden">
                  {% render 'golfers-stars' %}
                </div>
                <div class="cg-testimonial__author">
                  {% if block.settings.name != blank %}
                    <strong>{{ block.settings.name }}</strong>
                  {% endif %}
                  {% if block.settings.designation != blank %}
                    <span>{{ block.settings.designation }}</span>
                  {% endif %}
                </div>
              </div>
            </div>

            {% if block.settings.image != blank %}
              <div class="cg-testimonial__image cg-testimonial__image--desktop">
                <img
                  src="{{ block.settings.image | image_url }}"
                  alt="{{ block.settings.name | escape }}"
                  loading="lazy"
                  width="auto"
                  height="auto"
                >
              </div>
            {% endif %}
            {% if block.settings.mobile_image != blank %}
              <div class="cg-testimonial__image cg-testimonial__image--mobile">
                <img
                  src="{{ block.settings.mobile_image | image_url }}"
                  alt="{{ block.settings.name | escape }}"
                  loading="lazy"
                  width="auto"
                  height="auto"
                >
              </div>
            {% endif %}
          </div>
        </div>
      {% endfor %}

      {% if section.settings.enable_desktop_slider or section.settings.enable_mobile_slider %}
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% if section.settings.enable_desktop_slider or section.settings.enable_mobile_slider %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      if (typeof Swiper === 'undefined') return;

      document.querySelectorAll('.cg-testimonials').forEach(function (section) {
        const enableDesktop = section.dataset.desktopSlider === 'true';
        const enableMobile = section.dataset.mobileSlider === 'true';

        let swiperInstance = null;

        function initSwiper() {
          const isMobile = window.innerWidth <= 989;

          section.classList.remove('is-desktop-grid', 'is-mobile-stack');

          if (isMobile) {
            if (enableMobile) {
              if (!swiperInstance) {
                swiperInstance = new Swiper(section.querySelector('.cg-swiper'), {
                  slidesPerView: 1.1,
                  spaceBetween: 23,
                  loop: true,
                  navigation: {
                    nextEl: section.querySelector('.golfers-arrow.golfers-next'),
                    prevEl: section.querySelector('.golfers-arrow.golfers-prev'),
                  },
                });
              }
            } else {
              if (swiperInstance) swiperInstance.destroy(true, true);
              swiperInstance = null;
              section.classList.add('is-mobile-stack');
            }
          } else {
            if (enableDesktop) {
              if (!swiperInstance) {
                swiperInstance = new Swiper(section.querySelector('.cg-swiper'), {
                  spaceBetween: 53,
                  loop: true,
                  navigation: {
                    nextEl: section.querySelector('.golfers-arrow.golfers-next'),
                    prevEl: section.querySelector('.golfers-arrow.golfers-prev'),
                  },
                  breakpoints: {
                    990: {
                      slidesPerView: 1.5,
                    },
                    1440: {
                      slidesPerView: 2,
                    },
                  },
                });
              }
            } else {
              if (swiperInstance) swiperInstance.destroy(true, true);
              swiperInstance = null;
              section.classList.add('is-mobile-stack');
            }
          }
        }

        initSwiper();
        window.addEventListener('resize', initSwiper);
      });
    });
  </script>
{% endif %}

{% schema %}
{
  "name": "Golfers Testimonials",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "extra_class",
      "label": "Extra Class"
    },
    {
      "type": "richtext",
      "id": "heading",
      "label": "Section Heading"
    },
    {
      "type": "checkbox",
      "id": "enable_desktop_slider",
      "label": "Enable slider on desktop",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_mobile_slider",
      "label": "Enable slider on mobile",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "text",
          "id": "extra_class_slide",
          "label": "Extra Class"
        },
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Name"
        },
        {
          "type": "text",
          "id": "designation",
          "label": "Designation / Subtitle"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Desktop Image"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile Image"
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Golfers Testimonials",
      "blocks": [{ "type": "testimonial" }, { "type": "testimonial" }]
    }
  ]
}
{% endschema %}
