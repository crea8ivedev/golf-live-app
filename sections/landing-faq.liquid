<div class="landing-faq-main-box faq-section py-16 px-4 md:px-0 max-w-3xl mx-auto" id="faq-{{ section.id }}">
  {% if section.settings.heading != blank %}
    <h2 class="landing-faq-main-title text-3xl md:text-4xl font-bold text-center mb-12 text-gray-900">
      {{ section.settings.heading }}
    </h2>
  {% endif %}

  <div class="landing-faq-inner-wrapper flex flex-col gap-10">
    <div class="landing-faq-list faq-list border-t border-gray-200">
      {% for block in section.blocks %}
        {% if block.type == 'faq_item' %}
          <div class="landing-faq-item faq-item border-b border-gray-200" {{ block.shopify_attributes }}>
            <button
              type="button"
              class="landing-faq-question faq-question w-full flex items-center py-5 text-left group focus:outline-none"
              aria-expanded="false"
            >
              <span class="landing-faq-container faq-icon-container mr-4 flex-shrink-0 transition-transform duration-300 text-gray-500 group-hover:text-gray-800">
                {% if section.settings.icon_style == 'plus' %}
                  <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                  </svg>
                {% else %}
                  <svg
                    class="w-6 h-6"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                {% endif %}
              </span>

              <span class="landing-faq-question-text text-lg font-medium text-gray-800">
                {{- block.settings.question -}}
              </span>
            </button>

            <div class="faq-answer-wrapper overflow-hidden h-0 transition-[height] duration-350 ease-out">
              <div class="faq-answer pb-6 pl-10 text-gray-600 leading-relaxed opacity-0 transition-opacity duration-300">
                {{ block.settings.answer }}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    {% if section.settings.show_buttons %}
      <div class="landing-faq-btn-group flex flex-col sm:flex-row justify-center items-center gap-4 mt-4">
        {% if section.settings.btn_1_text != blank %}
          <a
            href="{{ section.settings.btn_1_link }}"
            class="landing-faq-btn-one w-full sm:w-auto px-8 py-4 bg-[#1a5119] hover:bg-[#123a11] text-white font-bold rounded-full text-center transition duration-300 uppercase tracking-wide"
          >
            {{ section.settings.btn_1_text }}
          </a>
        {% endif %}
        {% if section.settings.btn_2_text != blank %}
          <a
            href="{{ section.settings.btn_2_link }}"
            class="landing-faq-btn-two w-full sm:w-auto px-8 py-4 bg-white border border-gray-300 hover:bg-gray-50 text-gray-900 font-semibold rounded-full text-center transition duration-300"
          >
            {{ section.settings.btn_2_text }}
          </a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<style>
  /* Rotation logic based on settings */
  {% if section.settings.icon_style == 'plus' %}
    #faq-{{ section.id }} .faq-item.active .faq-icon-container { transform: rotate(45deg); }
  {% else %}
    #faq-{{ section.id }} .faq-item.active .faq-icon-container { transform: rotate(180deg); }
  {% endif %}

  /* Fade in answer when active */
  #faq-{{ section.id }} .faq-item.active .faq-answer {
    opacity: 1;
  }
</style>

<script>
  (function () {
    const section = document.getElementById('faq-{{ section.id }}');
    if (!section) return;

    const items = section.querySelectorAll('.faq-item');
    items.forEach((item) => {
      const button = item.querySelector('.faq-question');
      const wrapper = item.querySelector('.faq-answer-wrapper');

      button.addEventListener('click', () => {
        const isActive = item.classList.contains('active');

        // Close other items (Accordion behavior)
        items.forEach((i) => {
          i.classList.remove('active');
          i.querySelector('.faq-answer-wrapper').style.height = '0px';
        });

        if (!isActive) {
          item.classList.add('active');
          wrapper.style.height = wrapper.scrollHeight + 'px';
        }
      });
    });
  })();
</script>

{% schema %}
{
  "name": "FAQ Tailwind",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Common Questions from Coaches"
    },
    {
      "type": "select",
      "id": "icon_style",
      "label": "Icon Style",
      "options": [
        { "value": "plus", "label": "Plus/Minus" },
        { "value": "chevron", "label": "Chevron" }
      ],
      "default": "plus"
    },
    {
      "type": "header",
      "content": "Buttons"
    },
    {
      "type": "checkbox",
      "id": "show_buttons",
      "label": "Show Buttons",
      "default": true
    },
    {
      "type": "text",
      "id": "btn_1_text",
      "label": "Primary Button Text",
      "default": "START FREE TRIAL"
    },
    {
      "type": "url",
      "id": "btn_1_link",
      "label": "Primary Button Link"
    },
    {
      "type": "text",
      "id": "btn_2_text",
      "label": "Secondary Button Text",
      "default": "Schedule a Demo"
    },
    {
      "type": "url",
      "id": "btn_2_link",
      "label": "Secondary Button Link"
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How does it work?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Your answer goes here.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Tailwind",
      "blocks": [{ "type": "faq_item" }, { "type": "faq_item" }]
    }
  ]
}
{% endschema %}
