{% style %}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
  @media screen and (max-width: 1024px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top_tablet }}px;
      padding-bottom: {{ section.settings.padding_bottom_tablet }}px;
    }
  }
  @media screen and (max-width: 767px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top_mobile }}px;
      padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
    }
  }
{% endstyle %}
<div
  class="landing-faq-main-box faq-section px-[28px] max-w-[1009px] mx-auto section-{{ section.id }}-padding {{ section.settings.extra-class }}"
  id="faq-{{ section.id }}"
>
  {% if section.settings.heading != blank %}
    <h2 class="text-center mb-[16px] min-990:mb-[30px]">
      {{ section.settings.heading }}
    </h2>
  {% endif %}

  <div class="landing-faq-inner-wrapper flex flex-col">
    <div class="landing-faq-list faq-list">
      {% for block in section.blocks %}
        {% if block.type == 'faq_item' %}
          <div
            class="landing-faq-item faq-item border-b border-[#E5E5E5] min-990:border-[#CECECE]"
            {{ block.shopify_attributes }}
          >
            <button
              type="button"
              class="landing-faq-question faq-question w-full flex gap-x-[9px] min-990:gap-x-[19px] py-[12px] min-990:py-[25px] text-left group focus:outline-none cursor-pointer"
              aria-expanded="false"
            >
              <span class="landing-faq-container faq-icon-container flex-shrink-0 transition-transform duration-300 text-black">
                {% if section.settings.icon_style == 'plus' %}
                  <svg
                    class="w-[31px] h-[31px] max-990:hidden"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="1"
                  >
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                  </svg>
                {% else %}
                  <svg
                    class="w-[31px] h-[31px] max-990:hidden"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                {% endif %}
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="10"
                  viewBox="0 0 18 10"
                  fill="none"
                  class="min-990:hidden relative top-[8px]"
                >
                  <path d="M0.53125 0.530273L8.53125 8.53027L16.5313 0.530273" stroke="currentColor" stroke-width="1.5"/>
                </svg>
              </span>

              <span class="landing-faq-question-text font-semibold min-990:font-medium text-[16px] leading-[24px] tracking-[0.16px] min-990:text-[18px] min-990:leading-[28px] min-990:tracking-[0.18px]">
                {{- block.settings.question -}}
              </span>
            </button>

            <div class="faq-answer-wrapper overflow-hidden h-0 transition-[height] duration-350 ease-out">
              <div class="faq-answer text-black2 pb-[12px] min-990:pb-[25px] opacity-0 transition-opacity duration-300">
                {{ block.settings.answer }}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    {% if section.settings.show_buttons %}
      <div class="landing-faq-btn-group flex flex-wrap justify-center items-center gap-[17px] pt-[63px] max-990:hidden">
        {% if section.settings.btn_1_text != blank %}
          <a
            href="{{ section.settings.btn_1_link }}"
            class="landing-faq-btn-one ctm-button button-green px-[69px]"
          >
            {{ section.settings.btn_1_text }}
          </a>
        {% endif %}
        {% if section.settings.btn_2_text != blank %}
          <a
            href="{{ section.settings.btn_2_link }}"
            class="landing-faq-btn-two ctm-button button-white-outline px-[63px] font-semibold"
          >
            {{ section.settings.btn_2_text }}
          </a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<style>
  /* Rotation logic based on settings */
  @media (min-width: 990px) {
    {% if section.settings.icon_style == 'plus' %}
      #faq-{{ section.id }} .faq-item.active .faq-icon-container { transform: rotate(45deg); }
    {% else %}
      #faq-{{ section.id }} .faq-item.active .faq-icon-container { transform: rotate(180deg); }
    {% endif %}
  }

  @media (max-width: 989px) {
    #faq-{{ section.id }} .faq-item.active .faq-icon-container svg {
      transform: rotate(180deg);
    }
  }

  /* Fade in answer when active */
  #faq-{{ section.id }} .faq-item.active .faq-answer {
    opacity: 1;
  }
</style>

<script>
  (function () {
    const section = document.getElementById('faq-{{ section.id }}');
    if (!section) return;

    const items = section.querySelectorAll('.faq-item');

    items.forEach((item) => {
      const button = item.querySelector('.faq-question');
      const wrapper = item.querySelector('.faq-answer-wrapper');

      button.addEventListener('click', () => {
        const isActive = item.classList.contains('active');

        items.forEach((i) => {
          i.classList.remove('active');
          i.querySelector('.faq-answer-wrapper').style.height = '0px';
        });

        if (!isActive) {
          item.classList.add('active');
          wrapper.style.height = wrapper.scrollHeight + 'px';
        }
      });
    });

    if (items.length > 0) {
      const firstItem = items[0];
      const firstWrapper = firstItem.querySelector('.faq-answer-wrapper');
      firstItem.classList.add('active');
      firstWrapper.style.height = firstWrapper.scrollHeight + 'px';
    }
  })();
</script>

{% schema %}
{
  "name": "FAQ Tailwind",
  "settings": [
    {
      "type": "text",
      "id": "extra-class",
      "label": "Extra Class"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Common Questions from Coaches"
    },
    {
      "type": "select",
      "id": "icon_style",
      "label": "Icon Style",
      "options": [
        { "value": "plus", "label": "Plus/Minus" },
        { "value": "chevron", "label": "Chevron" }
      ],
      "default": "plus"
    },
    {
      "type": "header",
      "content": "Buttons"
    },
    {
      "type": "checkbox",
      "id": "show_buttons",
      "label": "Show Buttons",
      "default": true
    },
    {
      "type": "text",
      "id": "btn_1_text",
      "label": "Primary Button Text",
      "default": "START FREE TRIAL"
    },
    {
      "type": "url",
      "id": "btn_1_link",
      "label": "Primary Button Link"
    },
    {
      "type": "text",
      "id": "btn_2_text",
      "label": "Secondary Button Text",
      "default": "Schedule a Demo"
    },
    {
      "type": "url",
      "id": "btn_2_link",
      "label": "Secondary Button Link"
    },
    {
      "type": "header",
      "content": "Desktop Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top Desktop",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom Desktop",
      "default": 52
    },
    {
      "type": "header",
      "content": "Tablet Padding"
    },
    {
      "type": "range",
      "id": "padding_top_tablet",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top Tablet",
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_bottom_tablet",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom Tablet",
      "default": 50
    },
    {
      "type": "header",
      "content": "Mobile Padding"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top Mobile",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom Mobile",
      "default": 52
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How does it work?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Your answer goes here.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Tailwind",
      "blocks": [{ "type": "faq_item" }, { "type": "faq_item" }]
    }
  ]
}
{% endschema %}
